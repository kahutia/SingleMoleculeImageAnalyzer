%% 3rd order polynomial w. Cross terms
function [mappedx, mappedy] = map_pt2pt(x,y,map)

mappedx= round(map(1,1) +...
    map(1,2)*x + map(1,3)*y +...
    map(1,4)*x^2 + map(1,5)*y^2 +...
    map(1,6)*x^3 + map(1,7)*y^3 +...
    map(1,8)*x*y +...
    map(1,9)*x^2*y + map(1,10)*x*y^2);
mappedy= round(map(2,1) +...
    map(2,2)*x + map(2,3)*y +...
    map(2,4)*x^2 + map(2,5)*y^2 +...
    map(2,6)*x^3 + map(2,7)*y^3 +...
    map(2,8)*x*y +...
    map(2,9)*x^2*y + map(2,10)*x*y^2);
